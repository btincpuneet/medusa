# .env (in your Medusa project root)

# Medusa config
MEDUSA_ADMIN_ONBOARDING_TYPE=default
STORE_CORS=http://localhost:8000,https://docs.medusajs.com
ADMIN_CORS=http://localhost:5173,http://localhost:9000,https://docs.medusajs.com
AUTH_CORS=http://localhost:5173,http://localhost:9000,http://localhost:8000,https://docs.medusajs.com
DEFAULT_LOCATION_NAME=Default Warehouse


REDIS_URL=redis://localhost:6379
JWT_SECRET=supersecret
COOKIE_SECRET=supersecret
DATABASE_URL=postgres://postgres:admin0178%40@localhost/medusa-my-backend

MEDUSA_BASE_URL=http://localhost:9000
MEDUSA_ADMIN_EMAIL=prashantkaushik700@gmail.com
MEDUSA_ADMIN_PASSWORD=Pkaushik0178@
MEDUSA_ADMIN_TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhY3Rvcl9pZCI6IiIsImFjdG9yX3R5cGUiOiJjdXN0b21lciIsImF1dGhfaWRlbnRpdHlfaWQiOiJhdXRoaWRfMDFLNlpFSDY2M0g3WFlHOVE2S1JCQUdIMFYiLCJhcHBfbWV0YWRhdGEiOnt9LCJpYXQiOjE3NjAzNjQ5ODgsImV4cCI6MTc2MDQ1MTM4OH0.BR23m1EkPl5C1CLNEn8EzilU4JmBEsCkipMBtrSnYRQ
MEDUSA_PUBLISHABLE_KEY=pk_c4179b29c693ec6adac6335900bd5d95d0459689d72c1ca219cecbcef4ff9621
MEDUSA_SECRET_API_KEY=sk_34439b16310eef307df966a17802bd67aae51c3ac0f21bb9f7ddb28f73c8b2d0
MEDUSA_FF_PRODUCT_CATEGORIES=true

# Magento
MAGENTO_REST_BASE_URL=http://local.b2c.com/rest/V1
MAGENTO_ADMIN_TOKEN=eyJraWQiOiIxIiwiYWxnIjoiSFMyNTYifQ.eyJ1aWQiOjEwLCJ1dHlwaWQiOjIsImlhdCI6MTc2MDQ3MDUwNywiZXhwIjozNjAwMTc2MDQ3MDUwN30.kDJCYXS51sKMxZt-EMY3To3rA4pDv7_k5eQYOnmh0sw
MAGENTO_COMPANY_CODE=1140
MAGENTO_ACCESS_ID=6
MAGENTO_EXTRA_QUERY=company_code=1140&accessId=6&searchCriteria[filter_groups][0][filters][0][field]=status&searchCriteria[filter_groups][0][filters][0][value]=1&searchCriteria[filter_groups][0][filters][0][condition_type]=eq


# ---- Added for smoother v2 setup ----

# Runtime
NODE_ENV=development
PORT=9000
LOG_LEVEL=info
# Force Vite/Chokidar to use polling watchers to avoid ENOSPC errors
CHOKIDAR_USEPOLLING=1
CHOKIDAR_INTERVAL=350
# Vite HMR port for the admin (helps avoid random, firewalled ports)
 HMR_HOST=0.0.0.0
 HMR_PORT=9001
 HMR_CLIENT_PORT=9001
 HMR_PROTOCOL=ws

# Extra local CORS origins (useful for React/Vite/Next dev UIs)
STORE_CORS_EXTRA=http://localhost:3000,http://localhost:5173
ADMIN_CORS_EXTRA=http://localhost:7001
AUTH_CORS_EXTRA=http://localhost:3000,http://localhost:5173

# Real Admin API Key (create in Admin → Settings → API Keys → type: admin)
MEDUSA_ADMIN_API_KEY=sk_34439b16310eef307df966a17802bd67aae51c3ac0f21bb9f7ddb28f73c8b2d0

# Default setup values for scripts / migration helpers
DEFAULT_CURRENCY_CODE=inr
DEFAULT_LOCATION_NAME=Default Warehouse
DEFAULT_LOCATION_ID=   # fill after creating stock location
DEFAULT_SALES_CHANNEL_ID=   # fill after creating/listing sales channels

# Storefront usage
PUBLIC_PUBLISHABLE_KEY=${MEDUSA_PUBLISHABLE_KEY}

# Magento import helpers
MAGENTO_PRICE_CURRENCY=INR
MAGENTO_DEFAULT_TAX_RATE=0

# Optional modules / feature control
ENABLE_PRODUCT_MODULE=true
ENABLE_PRICING_MODULE=true
ENABLE_INVENTORY_MODULE=true
ENABLE_STOCK_LOCATION_MODULE=true
ENABLE_CURRENCY_MODULE=true

# Magento database connection (for migration scripts)
MAGENTO_DB_HOST=localhost
MAGENTO_DB_PORT=3306
MAGENTO_DB_NAME=radington
MAGENTO_DB_USER=root
MAGENTO_DB_PASSWORD=root

# SAP integration (sourced from Magento core_config_data)
REDINGTON_SAP_API_URL=http://172.20.37.18/b2cconnect/rest/v1/
REDINGTON_SAP_API_CLIENT_ID=B5855950F4F14404838CD7009EE233B3
REDINGTON_SAP_API_CLIENT_SECRET=D05F4950EA834300B5C1A81C66F855FA
REDINGTON_SAP_KSA_COMPANY_CODE=9110
REDINGTON_SAP_CUSTOMER_NUMBER=1110000080
REDINGTON_SAP_INVOICE_API_URL=http://172.20.37.18/PTR_Lib/rest/Util/GetInvoices
REDINGTON_SAP_INVOICE_PDF_API_URL=http://172.20.37.18/PTR_Lib/rest/Util/GetInvoicePDF
REDINGTON_SAP_INVOICE_CLIENT_ID=38ff30891479123439aea6344eb6a1e
REDINGTON_SAP_INVOICE_CLIENT_SECRET=a23444df099534048b54ebAFd32B98E76
REDINGTON_SAP_DOMAIN=https://b2cqaapp.redingtonmea.com
REDINGTON_SAP_NOTIFICATION_RECIPIENTS=sakib.ahamad@redingtongroup.com

# MPGS payment integration
REDINGTON_PAYMENT_API_URL=https://test-epaygib.mtf.gateway.mastercard.com/api/rest/version/66/merchant/
REDINGTON_PAYMENT_USERNAME=REDTEST0006
REDINGTON_PAYMENT_PASSWORD=13538e4ae8e0cd27c18e80f714ffd4e2
REDINGTON_AVAILABLE_PAYMENT_METHODS=ccavenue,checkmo




Ran node scripts/test-customer-login.js --email 'Prashantkaushik700@gmail.com' --password 'Pkaushik0178@' after the .env change. Medusa now accepts the publishable key, but the /store/migrate-login handler (src/api/store/migrate-login/route.ts) crashes because the request scope can’t resolve customerService, so the server responds 500 before the script can verify the password.
To exercise the login logic right away, keep using the auth service directly: CUSTOMER_LOGIN_PATH=/auth/customer/emailpass node scripts/test-customer-login.js --email 'Prashantkaushik700@gmail.com' --password 'Pkaushik0178@' (this returns a token as before).
To make the storefront endpoint work, ensure customerService is registered in the Medusa DI container—e.g., enable the customer module in medusa-config.js, or manually register the legacy service so req.scope.resolve("customerService") succeeds. Once the backend resolves that dependency, rerun the script without overriding CUSTOMER_LOGIN_PATH; it should then validate the user via the store API.
